CostModel_v3.0_Modular.xlsx

ğŸ“„ CONFIG (Inputs Only - No Calculations)
   â”œâ”€ FX_Rates (date, USD_CAD, USD_EURO)
   â”œâ”€ Project_Parameters (SG, LOM, penetration_rate, availability)
   â”œâ”€ Equipment_Catalog (item, base_cost, currency, unit)
   â””â”€ Labor_Catalog (role, annual_rate, currency, utilization_factor)

ğŸ“„ RATES (Calculation Layer - Atomic Functions)
   â”œâ”€ Equipment_Rates (cost per day/month/year, FX-adjusted)
   â”œâ”€ Consumable_Rates (cost per meter, with wear curves)
   â”œâ”€ Labor_Rates (loaded cost per hour, per role)
   â””â”€ Fuel_Rates (cost per liter, with volatility scenarios)

ğŸ“„ POLICIES (Business Logic)
   â”œâ”€ Margin_Rules (cost_category â†’ margin_pct)
   â”œâ”€ Risk_Premiums (project_attributes â†’ premium_pct)
   â”œâ”€ Volume_Discounts (quantity_thresholds â†’ discount_pct)
   â””â”€ Allocation_Rules (fixed_costs â†’ allocation_method)

ğŸ“„ CALCULATOR (Block-Level Marginal Cost Engine) â­
   â”œâ”€ Input: Block characteristics (depth, tonnage, grade)
   â”œâ”€ Logic: Lookup from RATES, apply POLICIES
   â”œâ”€ Output: Cost per tonne/meter, with breakdown
   â””â”€ THIS IS THE SIMULATION INTERFACE

ğŸ“„ AGGREGATOR (Project-Level Rollup)
   â”œâ”€ Time-series projection (monthly cashflow for board)
   â”œâ”€ References CALCULATOR for per-block costs
   â”œâ”€ Adds fixed costs, G&A, revenue share
   â””â”€ THIS REPLACES YOUR CURRENT SUMMARY SHEET

ğŸ“„ AUDIT_LOG (Version Control)
   â”œâ”€ Change history (who changed what, when)
   â”œâ”€ Assumption snapshots (record of inputs per scenario)
   â””â”€ Simulation runs (which cost version was used)

ğŸ“„ LEGACY_REFERENCE (Read-Only Archive)
   â”œâ”€ Full copy of current 16-sheet model
   â””â”€ For cross-checking during migration only

================================================================================
IMPLEMENTATION STATUS (TypeScript/React)
================================================================================

âœ… BUILT:

src/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ cost-model-schema.ts      # Comprehensive type definitions
â”‚   â””â”€â”€ cost-model-config.ts      # CONFIG layer implementation
â”‚
â”œâ”€â”€ engine/
â”‚   â””â”€â”€ CostCalculationEngine.ts  # RATES, POLICIES, CALCULATOR, AGGREGATOR
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ CostModelConfigurator.tsx # Full UI with tabbed interface
â”‚
â”œâ”€â”€ styles/
â”‚   â””â”€â”€ configurator.css          # Fintech-grade design system
â”‚
â”œâ”€â”€ App.tsx                       # Main application with Dashboard & Reports
â””â”€â”€ index.ts                      # Public API exports

sample-config.json                # Complete example configuration

================================================================================
ARCHITECTURE SUMMARY
================================================================================

Layer 0: CONFIG (Pure Inputs)
   - FX rates with locking for budget periods
   - Project parameters: SG, LOM, penetration rates, availability
   - Equipment catalog with specs, lifecycle, vendor info
   - Labor catalog with burden rates, certifications

Layer 1: RATES (Derived Atomic Functions)
   - Equipment: $/hour, $/day, $/month, $/year (FX-adjusted)
   - Labor: Loaded hourly rate, effective rate (adjusted for utilization)
   - Consumables: $/meter with depth wear curves, rock type factors
   - Fuel: Base rates with volatility scenarios for sensitivity

Layer 2: POLICIES (Business Logic)
   - Margin rules by cost category with validity periods
   - Risk premiums triggered by block attributes (depth, hardness)
   - Volume discount tiers
   - Fixed cost allocation methods (tonnage, meters, headcount, revenue)

Layer 3: CALCULATOR (Block-Level Engine)
   - Input: BlockCharacteristics (depth, tonnage, grade, rock properties)
   - Process: Apply RATES â†’ Apply POLICIES â†’ Add contingency
   - Output: BlockCostResult with full breakdown

Layer 4: AGGREGATOR (Project-Level)
   - Time-series cashflow projection
   - NPV, IRR, payback period calculations
   - Sensitivity analysis engine
   - Board-ready summaries

================================================================================
KEY FEATURES
================================================================================

CAPEX Handling:
- Equipment depreciation (straight-line, per-block allocation)
- Installation, commissioning costs
- Infrastructure allocation
- Working capital requirements

OPEX Handling:
- Direct labor (operators, technicians)
- Indirect labor (supervision, safety)
- Consumables with wear curves
- Energy (electricity with peak pricing, fuel)
- Maintenance (preventive, corrective)
- G&A overhead allocation

Fintech Features:
- Full audit trail on every change
- Assumption snapshots for scenario comparison
- Simulation run history
- Multi-currency with FX management
- Role-based field validation
- Real-time OEE calculations
- Import/Export JSON configurations
